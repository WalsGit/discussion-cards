{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@walsgit/flarum-discussion-cards/webpack/bootstrap","webpack://@walsgit/flarum-discussion-cards/webpack/runtime/compat get default export","webpack://@walsgit/flarum-discussion-cards/webpack/runtime/define property getters","webpack://@walsgit/flarum-discussion-cards/webpack/runtime/hasOwnProperty shorthand","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['app']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['extend']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Button']\"","webpack://@walsgit/flarum-discussion-cards/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@walsgit/flarum-discussion-cards/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/Component']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/utils/craftBadges.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/getPostImage.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Link']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['tags/utils/sortTags']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/utils/craftTags.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/utils/humanTime']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/utils/string']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/components/LastReplies.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/compareTags.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/components/CardItem.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/components/ListItem.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/compat.js","webpack://@walsgit/flarum-discussion-cards/external assign \"flarum.core\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","import icon from 'flarum/common/helpers/icon';\r\nimport Tooltip from 'flarum/common/components/Tooltip';\r\n\r\nexport default function craftBadges(badges) {\r\n  if (badges.length) {\r\n    return [m('.cardBadges', [badges.map((badge) => {\r\n      return [\r\n        m(Tooltip, {\r\n          text: badge.attrs.label[0],\r\n          position: 'right'\r\n        },\r\n        m('span.cardBadge.Badge.Badge--' + badge.attrs.type, [icon(badge.attrs.icon)]))]\r\n    })])];\r\n  }\r\n};\r\n","export default function getPostImage(post, defaultImage, key = 1) {\r\n\r\n  const regex = /<img(?!.*?class=\"emoji\").*?src=[\\'\"](.*?)[\\'\"].*?>/;\r\n  const image = defaultImage;\r\n  const defaultImg = app.forum.attribute(\"baseUrl\") + \"/assets/\" + image;\r\n\r\n  if (post) {\r\n    const src = regex.exec(post.contentHtml());\r\n    if (typeof key === \"number\" && key > 0) {\r\n      return (src) ? src[key] : (image ? defaultImg : null);\r\n    } else if (key === '~') {\r\n      return src;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/utils/sortTags'];","import Link from 'flarum/common/components/Link';\r\nimport sortTags from 'flarum/tags/utils/sortTags';\r\n\r\nexport default function craftTags(tags) {\r\n  if (tags) {\r\n    return [sortTags(tags).map(function (tag) {\r\n      return [\r\n        <Link className=\"cardTag\"\r\n              style={{backgroundColor: tag.color()}}\r\n              href={app.route('tag', {tags: tag.slug()})}>\r\n          {tag.name()}\r\n        </Link>\r\n      ]\r\n    })];\r\n  }\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/string'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","import Component from 'flarum/common/Component';\r\nimport avatar from 'flarum/common/helpers/avatar';\r\n\r\n\r\nexport default class LastReplies extends Component {\r\n\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n    this.discussion = this.attrs.discussion;\r\n  }\r\n\r\n  view() {\r\n    const discussion = this.discussion;\r\n\r\n    // let's assume that the last 10 posts will be enough for us to identify 3 unique users\r\n    const posts = discussion.posts().splice(-10);\r\n\r\n    const filteredPosts = posts\r\n      .filter((post) => {\r\n        return !post.isHidden() && post.number() !== 1 && post.contentType() === \"comment\";\r\n      })\r\n      .sort((a, b) => b.createdAt() - a.createdAt());\r\n\r\n    const groupedUsers = filteredPosts\r\n      .map(post => post.user())\r\n      .filter((user, i, self) => {\r\n        return self.indexOf(user) === i\r\n      })\r\n      .reverse()\r\n      // last 3 users\r\n      .splice(-3);\r\n\r\n\r\n    return groupedUsers.map(user => {\r\n      return avatar(user, {className: 'Avatar--mini'})\r\n    })\r\n\r\n  }\r\n\r\n}\r\n","export default function compareTags(currentTag, priorityTag) {\r\n    if (currentTag.isChild && !priorityTag.isChild) return -1;\r\n    if (!currentTag.isChild && priorityTag.isChild) return 1;\r\n    if (currentTag.isChild && priorityTag.isChild && currentTag.parent === priorityTag.parent) return currentTag.position - priorityTag.position;\r\n    if (currentTag.isChild && priorityTag.isChild && currentTag.parent !== priorityTag.parent) return currentTag.parent - priorityTag.parent;\r\n\r\n    if (!currentTag.position && priorityTag.position) return 1;\r\n    if (currentTag.position && !priorityTag.position) return -1;\r\n    if (currentTag.position && priorityTag.position) return currentTag.position - priorityTag.position;\r\n    return currentTag.id - priorityTag.id;\r\n}","import Component from \"flarum/common/Component\";\r\nimport craftBadges from \"../utils/craftBadges\";\r\nimport getPostImage from \"../helpers/getPostImage\";\r\nimport craftTags from \"../utils/craftTags\";\r\nimport humanTime from \"flarum/common/utils/humanTime\";\r\nimport icon from \"flarum/common/helpers/icon\";\r\nimport username from \"flarum/common/helpers/username\";\r\nimport Dropdown from \"flarum/common/components/Dropdown\";\r\nimport DiscussionControls from \"flarum/forum/utils/DiscussionControls\";\r\nimport Link from \"flarum/common/components/Link\";\r\nimport { truncate } from \"flarum/common/utils/string\";\r\nimport LastReplies from \"./LastReplies\";\r\nimport compareTags from \"../helpers/compareTags\";\r\n\r\nexport default class cardItem extends Component {\r\n\toninit(vnode) {\r\n\t\tsuper.oninit(vnode);\r\n\t\tthis.discussion = this.attrs.discussion;\r\n\t}\r\n\r\n\tview() {\r\n\t\tconst discussion = this.discussion;\r\n\t\tconst settings = {};\r\n\t\tfor (const key in app.forum.data.attributes) {\r\n\t\t\tif (key.startsWith('walsgitDiscussionCards')) {\r\n\t\t\t\tlet newKey = key.replace('walsgitDiscussionCards', '');\r\n\t\t\t\tnewKey = newKey.replace(/^./, newKey.charAt(0).toLowerCase());\r\n\t\t\t\tsettings[newKey] = app.forum.data.attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst isTagPage = m.route.get().split('?')[0].startsWith('/t/');\r\n\t\tlet tagId;\r\n\t\tif (isTagPage) {\r\n\t\t\tconst slug = m.route.get().split('/t/')[1]?.split('?')[0];\r\n\t\t\ttagId = app.store.all('tags').find(t => t.slug() === slug).data.id;\r\n\t\t\tconst tag = app.store.all('tags').find(t => t.id() === tagId);\r\n\t\t\tconst tagSettings = tag ? JSON.parse(tag.data.attributes.walsgitDiscussionCardsTagSettings || '{}') : {};\r\n\t\t\tconst tagImage = tag ? tag.data.attributes.walsgitDiscussionCardsTagDefaultImage : null;\r\n\t\t\ttagSettings.defaultImage = tagImage;\r\n\r\n\t\t\tfor (const key in tagSettings) {\r\n\t\t\t\tif (settings.hasOwnProperty(key) && tagSettings[key] !== settings[key] && tagSettings[key] !== null) {\r\n\t\t\t\t\tsettings[key] = tagSettings[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* On the IndexPage (all discussions) checks which default image to show based on tag priority */\r\n\t\tconst isIndexPage = m.route.get().split('?')[0] === '/';\r\n\t\tif (isIndexPage) {\r\n\t\t\tconst tags = discussion.tags();\r\n\t\t\tfor (const key in tags) {\r\n\t\t\t\tconst tagId = tags[key].id();\r\n\t\t\t\tconst isChild = tags[key].isChild();\r\n\t\t\t\tconst parent = tags[key].data.hasOwnProperty('relationships') && tags[key].parent() ? tags[key].parent()['data'].id : null;\r\n\t\t\t\tconst position = tags[key].position();\r\n\t\t\t\tconst tagCustomImg = tags[key].attribute('walsgitDiscussionCardsTagDefaultImage');\r\n\t\t\t\tconst currentTag = { id: tagId, isChild, parent, position, tagCustomImg }\r\n\t\t\t\tlet priorityTag = null;\r\n\t\t\t\tif (!settings.allowedTags.includes(tagId) || tagCustomImg === null) continue;\r\n\r\n\t\t\t\tif (priorityTag === null || compareTags(currentTag, priorityTag) < 0) {\r\n\t\t\t\t\tpriorityTag = { id: tagId, isChild, parent, position, tagCustomImg };\r\n\t\t\t\t\tsettings.defaultImage = tagCustomImg;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst isRead = Number(settings.markReadCards) === 1 && discussion.isRead() && app.session.user ? \"read\" : \"\";\r\n\t\tconst attrs = {};\r\n\t\tattrs.className =\r\n\t\t\t\"wrapImg\" + (Number(settings.showAuthor) === 1 ? \" After\" : \"\");\r\n\t\tconst image = getPostImage(discussion.firstPost(), settings.defaultImage);\r\n\t\tconst media = image ? (\r\n\t\t\t<img\r\n\t\t\t\tsrc={image}\r\n\t\t\t\tclassName=\"previewCardImg\"\r\n\t\t\t\talt={discussion.title()}\r\n\t\t\t\tloading=\"lazy\"\r\n\t\t\t/>\r\n\t\t) : (\r\n\t\t\t<div className=\"imgStub\" />\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tkey={discussion.id()}\r\n\t\t\t\tdata-id={discussion.id()}\r\n\t\t\t\tdata-tag-id={isTagPage ? tagId : null}\r\n\t\t\t\tclassName={\r\n\t\t\t\t\t\"CardsListItem Card \" +\r\n\t\t\t\t\tisRead +\r\n\t\t\t\t\t(discussion.isHidden() ? \" Hidden\" : \"\")\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{DiscussionControls.controls(discussion, this).toArray().length\r\n\t\t\t\t\t? m(\r\n\t\t\t\t\t\t\tDropdown,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ticon: \"fas fa-ellipsis-v\",\r\n\t\t\t\t\t\t\t\tclassName: \"DiscussionListItem-controls\",\r\n\t\t\t\t\t\t\t\tbuttonClassName:\r\n\t\t\t\t\t\t\t\t\t\"Button Button--icon Button--flat Slidable-underneath Slidable-underneath--right\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tDiscussionControls.controls(\r\n\t\t\t\t\t\t\t\tdiscussion,\r\n\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t).toArray()\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t: \"\"}\r\n\t\t\t\t<Link\r\n\t\t\t\t\thref={app.route.discussion(discussion, 0)}\r\n\t\t\t\t\tclassName=\"cardLink\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{Number(settings.showBadges) === 1\r\n\t\t\t\t\t\t? craftBadges(discussion.badges().toArray())\r\n\t\t\t\t\t\t: \"\"}\r\n\r\n\t\t\t\t\t<div {...attrs}>\r\n\t\t\t\t\t\t{Number(settings.showViews) === 1 &&\r\n\t\t\t\t\t\t!isNaN(discussion.views()) ? (\r\n\t\t\t\t\t\t\t<div className=\"imageLabel discussionViews\">\r\n\t\t\t\t\t\t\t\t{icon(\"fas fa-eye\", { className: \"labelIcon\" })}\r\n\t\t\t\t\t\t\t\t{discussion.views()}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{media}\r\n\r\n\t\t\t\t\t\t{Number(settings.showAuthor) === 1 ? (\r\n\t\t\t\t\t\t\t<div className=\"cardFoot\">\r\n\t\t\t\t\t\t\t\t<div className=\"Author\">\r\n\t\t\t\t\t\t\t\t\t{username(discussion.user())}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"Date\">\r\n\t\t\t\t\t\t\t\t\t{humanTime(discussion.createdAt())}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"cardTags\">\r\n\t\t\t\t\t\t{craftTags(discussion.tags())}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"cardTitle\">\r\n\t\t\t\t\t\t<h2>{discussion.title()}</h2>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{Number(settings.previewText) === 1 && discussion.firstPost() ? (\r\n\t\t\t\t\t\t<div className=\"previewPost\">\r\n\t\t\t\t\t\t\t{truncate(\r\n\t\t\t\t\t\t\t\tdiscussion.firstPost().contentPlain(),\r\n\t\t\t\t\t\t\t\t150\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{Number(settings.showReplies) === 1 ? (\r\n\t\t\t\t\t\t<div className=\"cardSpacer\">\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tclassName=\"Replies\"\r\n\t\t\t\t\t\t\t\thref={app.route.discussion(\r\n\t\t\t\t\t\t\t\t\tdiscussion,\r\n\t\t\t\t\t\t\t\t\tdiscussion.lastPostNumber()\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div className=\"Left\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"Avatars\">\r\n\t\t\t\t\t\t\t\t\t\t{m(LastReplies, {\r\n\t\t\t\t\t\t\t\t\t\t\tdiscussion: discussion,\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"Repcount\">\r\n\t\t\t\t\t\t\t\t\t\t{app.translator.trans(\r\n\t\t\t\t\t\t\t\t\t\t\t\"walsgit_discussion_cards.forum.replies\",\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tcount:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdiscussion.replyCount() ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"0\",\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"Arrow\">\r\n\t\t\t\t\t\t\t\t\t{icon(\"fas fa-angle-right\")}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Link>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import Component from \"flarum/common/Component\";\r\nimport craftBadges from \"../utils/craftBadges\";\r\nimport getPostImage from \"../helpers/getPostImage\";\r\nimport craftTags from \"../utils/craftTags\";\r\nimport humanTime from 'flarum/common/utils/humanTime';\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport username from 'flarum/common/helpers/username';\r\nimport Dropdown from 'flarum/common/components/Dropdown';\r\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\r\nimport Link from 'flarum/common/components/Link';\r\nimport {truncate} from 'flarum/common/utils/string';\r\nimport LastReplies from './LastReplies';\r\nimport compareTags from \"../helpers/compareTags\";\r\n\r\n\r\nexport default class listItem extends Component {\r\n\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n  }\r\n\r\n  view() {\r\n    const discussion = this.attrs.discussion;\r\n    const settings = {};\r\n    for (const key in app.forum.data.attributes) {\r\n\t\t\tif (key.startsWith('walsgitDiscussionCards')) {\r\n\t\t\t\tlet newKey = key.replace('walsgitDiscussionCards', '');\r\n\t\t\t\tnewKey = newKey.replace(/^./, newKey.charAt(0).toLowerCase());\r\n\t\t\t\tsettings[newKey] = app.forum.data.attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\r\n    const isTagPage = m.route.get().split('?')[0].startsWith('/t/');\r\n\t\tif (isTagPage) {\r\n      const slug = m.route.get().split('/t/')[1]?.split('?')[0];\r\n      const tagId = app.store.all('tags').find(t => t.slug() === slug).data.id;\r\n      const tag = app.store.all('tags').find(t => t.id() === tagId);\r\n      const tagSettings = tag ? JSON.parse(tag.data.attributes.walsgitDiscussionCardsTagSettings || '{}') : {};\r\n      const tagImage = tag ? tag.data.attributes.walsgitDiscussionCardsTagDefaultImage : null;\r\n      tagSettings.defaultImage = tagImage;\r\n\r\n      for (const key in tagSettings) {\r\n        if (settings.hasOwnProperty(key) && tagSettings[key] !== settings[key] && tagSettings[key] !== null) {\r\n          settings[key] = tagSettings[key];\r\n        }\r\n      }\r\n    }\r\n    /* On the IndexPage (all discussions) checks which default image to show based on tag priority */\r\n\t\tconst isIndexPage = m.route.get().split('?')[0] === '/';\r\n\t\tif (isIndexPage) {\r\n\t\t\tconst tags = discussion.tags();\r\n\t\t\tfor (const key in tags) {\r\n\t\t\t\tconst tagId = tags[key].id();\r\n\t\t\t\tconst isChild = tags[key].isChild();\r\n\t\t\t\tconst parent = tags[key].data.hasOwnProperty('relationships') && tags[key].parent() ? tags[key].parent()['data'].id : null;\r\n\t\t\t\tconst position = tags[key].position();\r\n\t\t\t\tconst tagCustomImg = tags[key].attribute('walsgitDiscussionCardsTagDefaultImage');\r\n\t\t\t\tconst currentTag = { id: tagId, isChild, parent, position, tagCustomImg }\r\n\t\t\t\tlet priorityTag = null;\r\n\t\t\t\tif (!settings.allowedTags.includes(tagId) || tagCustomImg === null) continue;\r\n\r\n\t\t\t\tif (priorityTag === null || compareTags(currentTag, priorityTag) < 0) {\r\n\t\t\t\t\tpriorityTag = { id: tagId, isChild, parent, position, tagCustomImg };\r\n\t\t\t\t\tsettings.defaultImage = tagCustomImg;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n    const isRead = Number(settings.markReadCards) === 1 && (discussion.isRead() && app.session.user) ? 'read' : '';\r\n    const attrs = {};\r\n    attrs.className = \"wrapImg\" + (Number(settings.showAuthor) === 1 ? \" After\" : '');\r\n    const image = getPostImage(discussion.firstPost(), settings.defaultImage);\r\n    const media = image\r\n      ? <img src={image}\r\n            className=\"previewCardImg\"\r\n            alt={discussion.title()}\r\n            loading=\"lazy\"/>\r\n      : <div className=\"imgStub\"/>\r\n\r\n    return (\r\n      <div key={discussion.id()}\r\n          data-id={discussion.id()}\r\n          className={\"CardsListItem List \" + isRead + (discussion.isHidden() ? \" Hidden\" : \"\")}>\r\n        {DiscussionControls.controls(discussion, this).toArray().length\r\n          ? m(Dropdown, {\r\n            icon: 'fas fa-ellipsis-v',\r\n            className: 'DiscussionListItem-controls',\r\n            buttonClassName: 'Button Button--icon Button--flat Slidable-underneath Slidable-underneath--right',\r\n          }, DiscussionControls.controls(discussion, this).toArray())\r\n          : ''}\r\n        <Link href={app.route.discussion(discussion, 0)}\r\n              className=\"cardLink\">\r\n\r\n          {Number(settings.showBadges) === 1\r\n            ? craftBadges(discussion.badges().toArray())\r\n            : ''}\r\n\r\n          <div className=\"cardGrid\">\r\n\r\n            <div className=\"rowSpan-3 colSpan\">\r\n              <div {...attrs}>\r\n                {Number(settings.showViews) === 1 && !isNaN(discussion.views())\r\n                  ? <div className=\"imageLabel discussionViews\">\r\n                    {icon('fas fa-eye', {className: 'labelIcon'})}\r\n                    {discussion.views()}\r\n                  </div>\r\n                  : ''}\r\n                {media}\r\n\r\n                {Number(settings.showAuthor) === 1\r\n                  ? <div className=\"cardFoot\">\r\n                    <div className=\"Author\">\r\n                      {username(discussion.user())}\r\n                    </div>\r\n                    <div className=\"Date\">\r\n                      {humanTime(discussion.createdAt())}\r\n                    </div>\r\n                  </div>\r\n                  : ''}\r\n\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"rowSpan-3 colSpan-2\">\r\n\r\n              <div className=\"flexBox\">\r\n                <div className=\"cardTitle\">\r\n                  <h2 title={discussion.title()} className=\"title\">{truncate(discussion.title(), 80)}</h2>\r\n                </div>\r\n                <div className=\"cardTags\">{craftTags(discussion.tags())}</div>\r\n              </div>\r\n\r\n              {Number(settings.previewText) === 1 && discussion.firstPost()\r\n                ? <div className=\"previewPost\">{truncate(discussion.firstPost().contentPlain(), 150)}</div>\r\n                : ''}\r\n\r\n              {app.screen() === 'phone' && Number(settings.showReplies) === 1\r\n                ? <div className=\"cardSpacer\">\r\n                  <Link\r\n                    className=\"Replies\"\r\n                    href={app.route.discussion(discussion, discussion.lastPostNumber())}>\r\n                    <div className=\"Left\">\r\n                      <div className=\"Avatars\">\r\n                        {m(LastReplies, {discussion: discussion})}\r\n                      </div>\r\n                      <div className=\"Repcount\">\r\n                        {app.translator.trans('walsgit_discussion_cards.forum.replies', {count: discussion.replyCount() || '0'})}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"Arrow\">\r\n                      {icon('fas fa-angle-right')}\r\n                    </div>\r\n                  </Link>\r\n                </div>\r\n                : Number(settings.showReplies) === 1 ?\r\n                  <div className=\"imageLabel discussionReplyCount\">\r\n                    {icon('fas fa-comment', {className: 'labelIcon'})}\r\n                    {discussion.replyCount()}\r\n                  </div> : ''\r\n              }\r\n            </div>\r\n          </div>\r\n        </Link>\r\n      </div>\r\n    );\r\n\r\n  }\r\n\r\n}\r\n","import CardItem from './components/CardItem';\r\nimport ListItem from './components/ListItem';\r\nimport LastReplies from './components/LastReplies';\r\nimport craftTags from \"./utils/craftTags\";\r\nimport craftBadges from \"./utils/craftBadges\";\r\n\r\nexport default {\r\n  'walsgit/discussion/cards/components/CardItem': CardItem,\r\n  'walsgit/discussion/cards/components/ListItem': ListItem,\r\n  'walsgit/discussion/cards/components/LastReplies': LastReplies,\r\n  'walsgit/discussion/cards/utils/craftTags': craftTags,\r\n  'walsgit/discussion/cards/utils/craftBadges': craftBadges,\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core;","import app from 'flarum/app';\r\nimport {extend, override} from 'flarum/extend';\r\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\r\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport Placeholder from 'flarum/common/components/Placeholder';\r\nimport Button from 'flarum/common/components/Button';\r\nimport CardItem from './components/CardItem';\r\nimport ListItem from './components/ListItem';\r\n\r\napp.initializers.add('walsgit/discussion/cards', () => {\r\n\r\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\r\n    if (app.current.matches(IndexPage)) {\r\n      params.include.push(['firstPost', 'posts', 'posts.user']);\r\n    }\r\n  });\r\n\r\n  override(DiscussionList.prototype, 'view', function (original) {\r\n    const settings = {};\r\n    for (const key in app.forum.data.attributes) {\r\n      if (key.startsWith('walsgitDiscussionCards')) {\r\n        let newKey = key.replace('walsgitDiscussionCards', '');\r\n        newKey = newKey.replace(/^./, newKey.charAt(0).toLowerCase());\r\n        settings[newKey] = app.forum.data.attributes[key];\r\n      }\r\n    }\r\n    const state = this.attrs.state;\r\n    const params = state.getParams();\r\n    let loading;\r\n    if (state.isInitialLoading() || state.isLoadingNext()) {\r\n      loading = <LoadingIndicator/>;\r\n    } else if (state.hasNext()) {\r\n      loading = Button.component(\r\n        {\r\n          className: 'Button',\r\n          onclick: state.loadNext.bind(state),\r\n        },\r\n        app.translator.trans('core.forum.discussion_list.load_more_button')\r\n      );\r\n    }\r\n    if (state.isEmpty()) {\r\n      const text = app.translator.trans('core.forum.discussion_list.empty_text');\r\n      return <div className=\"DiscussionList\">{m(Placeholder, {text})}</div>;\r\n    }\r\n    const isTagPage = m.route.get().split('?')[0].startsWith('/t/');\r\n    let tag = null;\r\n    if (isTagPage) {\r\n      tag = app.store.all('tags').find(t => t.slug() === params.tags).data.id;\r\n      const tagSettings = JSON.parse(app.store.all('tags').find(t => t.slug() === params.tags).data.attributes.walsgitDiscussionCardsTagSettings);\r\n      for (const key in tagSettings) {\r\n        if (settings.hasOwnProperty(key) && tagSettings[key] !== settings[key]) {\r\n          settings[key] = tagSettings[key];\r\n        }\r\n      }\r\n    }\r\n    if (app.current.matches(IndexPage) && ((settings.allowedTags.length && settings.allowedTags.includes(tag)) || (!params.tags && Number(settings.onIndexPage) === 1))) {\r\n      return (\r\n        <div className={'DiscussionList' + (state.isSearchResults() ? ' DiscussionList--searchResults' : '')}>\r\n          <div class=\"DiscussionList-discussions flexCard\">\r\n            {state.getPages().map((pg, o) => {\r\n              return pg.items.map((discussion, i) => {\r\n                return (i < Number(settings.primaryCards) && o === 0)\r\n                  ? m(CardItem, {discussion: discussion})\r\n                  : m(ListItem, {discussion: discussion})\r\n              });\r\n            })}\r\n          </div>\r\n          <div className=\"DiscussionList-loadMore\">{loading}</div>\r\n        </div>\r\n      );\r\n\r\n    } else {\r\n      return original();\r\n    }\r\n  })\r\n}, -1);\r\n\r\n\r\n// Expose compat API\r\nimport extCompat from './compat';\r\nimport {compat} from '@flarum/core/forum';\r\n\r\nObject.assign(compat, extCompat);\r\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","craftBadges","badges","length","m","map","badge","Tooltip","text","attrs","label","position","type","icon","getPostImage","post","defaultImage","image","defaultImg","app","forum","attribute","src","exec","contentHtml","craftTags","tags","sortTags","tag","Link","className","style","backgroundColor","color","href","route","slug","name","LastReplies","_Component","apply","arguments","_proto","oninit","vnode","this","discussion","view","posts","splice","filter","isHidden","number","contentType","sort","b","createdAt","user","i","self","indexOf","reverse","avatar","Component","compareTags","currentTag","priorityTag","isChild","parent","id","cardItem","settings","data","attributes","startsWith","newKey","replace","charAt","toLowerCase","tagId","isTagPage","split","_m$route$get$split$","store","all","find","tagSettings","JSON","parse","walsgitDiscussionCardsTagSettings","tagImage","walsgitDiscussionCardsTagDefaultImage","tagCustomImg","allowedTags","includes","isRead","Number","markReadCards","session","showAuthor","firstPost","media","alt","title","loading","DiscussionControls","toArray","Dropdown","buttonClassName","showBadges","showViews","isNaN","views","username","humanTime","previewText","truncate","contentPlain","showReplies","lastPostNumber","translator","trans","count","replyCount","listItem","screen","CardItem","ListItem","add","extend","DiscussionListState","params","matches","IndexPage","include","push","override","DiscussionList","original","state","getParams","isInitialLoading","isLoadingNext","LoadingIndicator","hasNext","Button","onclick","loadNext","isEmpty","Placeholder","onIndexPage","isSearchResults","class","getPages","pg","items","primaryCards","assign","extCompat"],"sourceRoot":""}